# Career Royale - 项目详情文档

## 一、项目概述

### 1.1 项目背景

Career Royale（职场大逃杀）是一款创新的 AI 面试模拟应用，将传统的面试准备过程转化为游戏化体验。通过 AI 技术，用户可以在安全的环境中体验真实面试场景，获得即时反馈。

### 1.2 核心价值

| 痛点 | 解决方案 |
|------|----------|
| 面试焦虑 | 游戏化降低心理压力 |
| 缺乏练习机会 | AI 无限次模拟面试 |
| 反馈不及时 | 实时评分和建议 |
| 准备方向不明 | 针对性问题生成 |

### 1.3 目标用户

- 求职者（应届生、跳槽者）
- 面试技巧提升需求者
- HR 培训场景

---

## 二、功能架构

### 2.1 用户流程

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   首页      │ -> │   战斗页    │ -> │   结果页    │ -> │   再来一局  │
│  输入简历   │    │  实时对战   │    │  评分反馈   │    │             │
│  选择难度   │    │  HP 变化    │    │  优劣分析   │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 2.2 核心功能模块

#### 2.2.1 简历解析
- 接收用户粘贴的简历文本
- 提取关键信息供 AI 分析

#### 2.2.2 职位匹配
- 预设职位模板（字节后端、腾讯产品等）
- 支持自定义 JD 输入

#### 2.2.3 难度系统

| 模式 | 面试官人设 | 问题风格 | 回合数 |
|------|-----------|----------|--------|
| Easy | 友善 HR | 基础问题、职业规划 | 3 轮 |
| Hard | 阿里 P8 架构师 | 技术深挖、压力测试 | 5 轮 |

#### 2.2.4 战斗系统
- HP 机制：双方各 100 HP
- 伤害计算：基于难度和回合数动态调整
- 实时状态：SSE 流式推送战斗进程

#### 2.2.5 评价系统
- 胜率预测（0-100%）
- 等级评定（S/A/B/C/D/F）
- 优势分析
- 改进建议

---

## 三、技术架构

### 3.1 整体架构

```
┌─────────────────────────────────────────────────────────┐
│                      Frontend                           │
│                   Vue 3 + Vite                          │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐                 │
│  │ Landing │  │ Battle  │  │ Result  │                 │
│  │  View   │  │  Arena  │  │  View   │                 │
│  └────┬────┘  └────┬────┘  └────┬────┘                 │
│       │            │            │                       │
│       └────────────┼────────────┘                       │
│                    │                                    │
│            ┌───────┴───────┐                           │
│            │ BattleService │                           │
│            └───────┬───────┘                           │
└────────────────────┼────────────────────────────────────┘
                     │ HTTP + SSE
┌────────────────────┼────────────────────────────────────┐
│                    │         Backend                    │
│            ┌───────┴───────┐                           │
│            │   Controller  │                           │
│            └───────┬───────┘                           │
│                    │                                    │
│  ┌─────────────────┼─────────────────┐                 │
│  │                 │                 │                 │
│  ▼                 ▼                 ▼                 │
│ ┌─────────┐  ┌─────────┐  ┌─────────┐                 │
│ │ Battle  │  │   AI    │  │ Common  │                 │
│ │ Service │──│ Service │  │  DTO    │                 │
│ └─────────┘  └────┬────┘  └─────────┘                 │
│                   │                                    │
└───────────────────┼────────────────────────────────────┘
                    │ OpenAI Compatible API
┌───────────────────┼────────────────────────────────────┐
│                   ▼                                    │
│         ┌─────────────────┐                           │
│         │  Qwen / GPT-4   │                           │
│         │   LLM Service   │                           │
│         └─────────────────┘                           │
└────────────────────────────────────────────────────────┘
```

### 3.2 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Vue 3 | ^3.5 | 响应式框架 |
| Vue Router | ^5.0 | 路由管理 |
| Vite | ^7.3 | 构建工具 |
| Tailwind CSS | ^4.1 | 样式框架 |

### 3.3 后端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| NestJS | ^10.3 | 后端框架 |
| TypeScript | ^5.3 | 类型安全 |
| OpenAI SDK | ^4.20 | AI API 调用 |
| class-validator | ^0.14 | 请求验证 |

### 3.4 通信协议

#### REST API
- `POST /api/battle/start` - 创建战斗会话
- `GET /api/battle/:id` - 查询战斗状态

#### SSE (Server-Sent Events)
- `GET /api/battle/:id/stream` - 实时战斗流

SSE 事件类型：
```typescript
type BattleEventType =
  | 'battle_start'      // 战斗开始
  | 'interviewer_attack' // 面试官提问
  | 'candidate_defend'   // 候选人回答
  | 'damage'            // 伤害事件
  | 'round_end'         // 回合结束
  | 'battle_end'        // 战斗结束
```

---

## 四、数据结构

### 4.1 请求 DTO

```typescript
// 开始战斗请求
interface StartBattleDto {
  resume: string;      // 简历内容
  jd: string;          // 职位描述
  mode: 'easy' | 'hard'; // 难度模式
}
```

### 4.2 响应格式

```typescript
// 统一响应格式
interface ApiResponse<T> {
  code: number;        // 状态码
  message: string;     // 消息
  data: T;             // 数据
  timestamp: number;   // 时间戳
}
```

### 4.3 战斗状态

```typescript
interface BattleState {
  id: string;
  resume: string;
  jd: string;
  mode: 'easy' | 'hard';
  interviewerHP: number;
  candidateHP: number;
  currentRound: number;
  turns: BattleTurn[];
  isActive: boolean;
}
```

### 4.4 战斗结果

```typescript
interface BattleResult {
  winRate: number;           // 胜率 0-100
  grade: 'S'|'A'|'B'|'C'|'D'|'F';
  summary: string;           // 总结
  strengths: string[];       // 优势
  weaknesses: string[];      // 不足
}
```

---

## 五、AI Prompt 设计

### 5.1 面试官问题生成

```
角色设定：
- Easy: 友善 HR，关注基本情况和职业规划
- Hard: 阿里 P8 架构师，深挖技术细节

输入：
- 候选人简历
- 职位要求
- 历史问答
- 当前回合

输出：
- 一个针对性的面试问题
```

### 5.2 候选人回答生成

```
角色设定：
- 基于简历内容的求职者
- 回答风格随难度调整

输入：
- 简历内容
- 职位要求
- 面试官问题

输出：
- 专业且有条理的回答
```

### 5.3 评价生成

```
输入：
- 完整面试对话
- 简历和职位信息

输出：
- JSON 格式评价
  - summary: 一句话总结
  - strengths: 优势列表
  - weaknesses: 不足列表
```

---

## 六、UI/UX 设计

### 6.1 设计风格

- **主题**: 暗色系 + Neo-brutalism
- **配色**:
  - 背景: #1a1a1a
  - 面试官: #ff4444 (红色)
  - 候选人: #4488ff (蓝色)
  - 强调: #ffff00 (黄色)

### 6.2 动效设计

| 效果 | 触发场景 | 实现方式 |
|------|----------|----------|
| Shake | 受到伤害 | CSS animation |
| Flash | HP 变化 | 红色闪烁覆盖层 |
| Glitch | 标题文字 | CSS clip + 伪元素 |
| Typing | 消息显示 | 逐字渲染 |

### 6.3 响应式设计

- 桌面端：双栏对战布局
- 移动端：单栏切换显示

---

## 七、部署说明

### 7.1 环境要求

- Node.js >= 18
- npm >= 9

### 7.2 环境变量

```env
# AI 服务配置
OPENAI_API_KEY=sk-xxx
OPENAI_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
OPENAI_MODEL=qwen-plus

# 服务配置
PORT=4000
```

### 7.3 生产部署

```bash
# 后端构建
cd backend
npm run build
npm run start:prod

# 前端构建
cd career-royale
npm run build
# 部署 dist 目录到静态服务器
```

---

## 八、扩展规划

### 8.1 短期优化

- [ ] 添加打字机效果
- [ ] 支持 PDF 简历上传
- [ ] 历史记录保存

### 8.2 中期功能

- [ ] 用户账号系统
- [ ] 多语言支持
- [ ] 更多面试官人设

### 8.3 长期愿景

- [ ] 语音面试模式
- [ ] 视频 Avatar
- [ ] 企业定制版

---

## 九、开发团队

Career Royale 项目

---

*文档版本: v1.0.0*
*更新时间: 2026-02-11*
